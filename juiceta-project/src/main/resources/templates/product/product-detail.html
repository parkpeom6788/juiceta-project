<!DOCTYPE html>
<html
  xmlns:th="http://www.thymeleaf.org"
  xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
  layout:decorate="~{layouts/layout}"
  xmlns:sec="http://www.thymeleaf.org/extras/spring-security"
> <!--/* 위 선언은 타임리프 레이아웃을 사용하기 위한 설정   */-->
<head>
	<title>product-detail</title>
</head>

	<div layout:fragment="content" class="container">
 		<div class="row">
			<div class="col-lg-6 mb-5 ftco-animate">
				<a href="" th:href="@{/images/}+${productVO.image}" class="image-popup"><img src="" th:src="@{/images/}+${productVO.image}" class="img-fluid" alt="Colorlib Template"></a>
			</div>
			<div class="col-lg-6 product-details pl-md-5 ftco-animate">
				<h3 th:text="${productVO.productName}">상품명</h3>
				<div class="rating d-flex">
					<p class="text-left mr-4">
						<span class="mr-2" style="color: green">평균별점</span>
						<span class="ion-ios-star" style="color: green"></span>
						<span class="ion-ios-star-outline" style="color: green"></span>
						<span class="ion-ios-star-outline" style="color: green"></span>
						<span class="ion-ios-star-outline" style="color: green"></span>
						<span class="ion-ios-star-outline" style="color: green"></span>
					</p>
				</div>
				<p class="price"><span>&#8361; </span><span th:text="${productVO.price}">상품가격</span></p>
				<p th:text="${productVO.productDetail}">상품상세설명</p>
				<div class="row mt-4">
					<div class="w-100"></div>
					<div class="input-group col-md-6 d-flex mb-3">
	          				<span class="input-group-btn mr-2">
	             				<button type="button" class="quantity-left-minus btn"  data-type="minus" data-field="">
	                				<i class="ion-ios-remove"></i>
	             				</button>
	         				</span>
	          				<input type="text" id="quantity" name="quantity" class="form-control input-number" value="1" min="1" max="100">
	          				<span class="input-group-btn ml-2">
	             				<button type="button" class="quantity-right-plus btn" data-type="plus" data-field="">
	                  				<i class="ion-ios-add"></i>
	              				</button>
	          				</span>
	       			</div>
       				<div class="w-100"></div>
      			</div>
      			<span id="addWishlist" class="btn btn-black py-3 px-5">찜하기</span>&nbsp;&nbsp;
      			<span id="addCart" class="btn btn-black py-3 px-4">장바구니담기</span>&nbsp;&nbsp;
      			<span id="goToCheckout" class="btn btn-black py-3 px-4">바로구매하기</span>
			</div>
		</div><br><br>
		
		<script type="text/javascript">
			$(document).ready(function(){
				let quantitiy=0;
	
				$(".quantity-right-plus").click(function(e){
			        // Stop acting like a button
			        e.preventDefault();
			        // Get the field name
			        quantity = parseInt($("#quantity").val());        
			        // If is not undefined  
			        $("#quantity").val(quantity + 1);
			        // Increment
			    });
	
			     $(".quantity-left-minus").click(function(e){
			        // Stop acting like a button
			        e.preventDefault();
			        // Get the field name
			        quantity = parseInt($('#quantity').val());
			        // If is not undefined
		            // Increment
		            if(quantity>0){
		            	$('#quantity').val(quantity - 1);
		            }
		    	 });
			     
				let urlSearch = new URLSearchParams(location.search);
				let productNo = urlSearch.get("productNo");
				
				$("#addWishlist").click(function() {
					$.ajax({
						type:"get",
						url:"/addWishlistAjax",
						data:"productNo="+productNo,
						success:function(result){
							if(result=="fail")
								alert("이미 찜목록에 추가된 상품입니다");
							else
								alert("찜 목록에 추가하였습니다");
						}
					});
				});
				
				$("#addCart").click(function() {
					let productCount = $("#quantity").val();
					$.ajax({
						type:"get",
						url:"/addCartAjax",
						data:"productNo="+productNo+"&productCount="+productCount,
						success:function(result){
							if(result=="fail")
								alert("이미 장바구니목록에 추가된 상품입니다");
							else{
								alert("장바구니 목록에 추가하였습니다");
								$("#totalCartCount").text(Number($("#totalCartCount").text())+1);
							}
						}
					});
				});
				
				$("#goToCheckout").click(function() {
					let productCount = $("#quantity").val();
					location.href = "/checkoutForm?productNo="+productNo+"&productCount="+productCount;
				});
			    
			});
		</script>
	
		<!--/* 문의사항 게시판 */-->
		<h2>Q&A</h2>
		<table class="table table-boardered">
			<thead>
				<tr>
					<th>회원 아이디</th>
					<th>Q&A제목</th>
					<th>작성일</th>
					<th>답변상태</th>
				</tr>
			</thead>
			<tbody>
				<tr th:each="question:${questionAllList}">
					<td th:text="${question.memberVO.id}" class = "col-sm-2"></td>
					<td class= "col-sm-3"><a th:text="${question.questionTitle}" th:href="@{/guest/question-detail?questionNo=}+${question.questionNo}"></a></td>
					<td th:text="${question.questionTime}" class = "col-sm-2"></td>
					<td th:text="${question.checkAnswer}" class = "col-sm-2"></td>
				</tr>
			</tbody>
		</table>
		<div align="right">
			<a  th:href="@{/question-write?productNo=}+${productNo}">글 쓰기</a>
		<!-- <form id="writeBtnForm" method="get" action="" th:action="@{/guest/question-write}">
			<input type="hidden" th:value="${productNo}" name="productNo">
			<button type="submit" id="writeBtn">글 작성 하기</button>
			<button onclick="location.href='question-write'">글 작성</button>
		</form> -->
		</div>
		<script type="text/javascript">
			$(document).ready(function() {
				$("#writeBtn").click(function() {
					let result = confirm("작성 하시겠습니까?")
					if(result!=true){
						return;
					}
					$("#writeBtnForm").submit();
				});			
			});
		</script>
	</div>
</html>